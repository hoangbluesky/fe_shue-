window.BiscuitsBundle=window.BiscuitsBundle||{},window.BiscuitsBundle.InitialiseBundleButtons=function(){const t=new WeakSet;function e(){this.bindData(),void 0!==this.bundleIds&&null!==this.bundleIds&&0!==this.bundleIds.length&&(this.globalProductFormSelectors=["[data-product-info]",".product-information","[data-product-blocks]",".main-product",".product__page",".product__section-container",".product-single__meta",".product-content-container",".product__details","product-rerender",".product-content-wrapper",".main--product-info-container",".single__product",".product-column-right",".product-section .product-page form",".main-product-form"],this.globalQuickAddSelectors=["add-to-cart",".product--quick-add--icon","[data-quick-add]","[data-add-to-cart]",".quick-add-btn",".product-card__quick-add-button",".product-card--add-to-cart-button",".quick-add form button",".card__quick-buttons button","product-quick-add button",".quick__form button","form .btn--add-to-cart",".card__quick-add form button",".quick-add-wrapper form button",".card__add-to-cart button",".product__quickbuy button",".product-item__quick-form button",".quick-buy-product-form button",".product-item button","[data-js-product-add-to-cart]",".js-ajax-submit",".product-card .product-form__cart-submit",".product-card__atc",".productitem--action-atc",".product-item__quick-add","quick-add-bulk",".product-item__quick-add-qty-selector",".card-product__sizes-btn.js-btn-size",".cc-quick-buy-btn","product-card [data-product-card-button]:not([data-quick-view-button])",".product__add-to-cart",".Sd_addProduct",".wbproduct-container form button",".product-card .form-card button",".product-card .form-card .input-amount",".group\\/product button",".m-add-to-cart",".boost-sd__button",".product-card__button",".card-product__quick-add"],this.globalGridItemSelectors=[".grid__item","product-card","product-grid-item",".product-item","[data-product-item]",".product-card",".collection-product-card",".collection__page-product","card-product",".product-tile",".product-block",".product-loop__item",".product--card",".product-holder",".yv-product-card",".group\\/product",".m-product-card",".boost-sd__product-item"],this.globalQuickViewSelectors=["quick-view",".btn-quickview",".product__quickbuy",".quick-view__button","[data-quickshop-full]","quick-view-drawer",".product-item__quick-view-button",".quick-product__btn",".collection__page-product .js-quickview-trigger",".product-card__quickview",".open-quick-view--btn","[data-quick-view-button]","[product-quickview-btn]",".product-quickview",".quickView",".quick-view__submit","modal-opener .quick-add__submit",".quick-shop__trigger",".quick-view-button .product-cart-btn",".quickbuy-toggle","modal-opener .card__link"],this.gridItemSelector.length>0?this.productGridItemQuery=this.gridItemSelector:this.embedData?.gis?.length>0?this.productGridItemQuery=this.embedData.gis.join(","):this.productGridItemQuery=this.globalGridItemSelectors.join(","),this.productPageFormSelector.length>0?this.productFormClasses=[this.productPageFormSelector]:this.embedData?.pfs?.length>0?this.productFormClasses=this.embedData.pfs:this.productFormClasses=this.globalProductFormSelectors,this.quickAddButtonSelector.length>0?this.cachedQuickAddQuery=this.quickAddButtonSelector:this.embedData?.qas?.length>0?this.cachedQuickAddQuery=this.embedData.qas.join(","):this.cachedQuickAddQuery=this.globalQuickAddSelectors.join(","),this.quickViewButtonSelector.length>0?this.cachedQuickViewQuery=this.quickViewButtonSelector:this.embedData?.qvs?.length>0?this.cachedQuickViewQuery=this.embedData.qvs.join(","):this.cachedQuickViewQuery=this.globalQuickViewSelectors.join(","),"off"!=this.quickAddDisplayRule&&"off"!=this.quickViewDisplayRule?this.initBothButtons():"off"!=this.quickAddDisplayRule?this.initQuickAddButtons():"off"!=this.quickViewDisplayRule&&this.initQuickViewButtons())}return e.prototype={bindData:function(){if(this.quickAddRules=window.BiscuitsBundle.quickAddRules,this.isProductPage=window.location.href.indexOf("/products/")>-1,this.themeStoreId=window.Shopify.theme.theme_store_id?window.Shopify.theme.theme_store_id.toString():null,this.appEmbedJsonElement=document.querySelector(".biscuits-bundle-app-embed__json"),this.themeDataJson=this.parseThemeData(),this.quickAddRules&&(this.bundleIds=this.quickAddRules.bundleProductIds,this.quickAddButtonSelector=this.quickAddRules.quickAddSelector,this.quickViewButtonSelector=this.quickAddRules.quickViewSelector,this.quickAddButtonClasses=this.quickAddRules.quickAddButtonClasses,this.quickAddDisplayRule=this.quickAddRules.quickAddDisplayRule,this.quickViewDisplayRule=this.quickAddRules.quickViewDisplayRules,this.gridItemSelector=this.quickAddRules.gridItemSelector,this.productPageFormSelector=this.quickAddRules.productPageFormSelector,this.linkText=this.quickAddRules.linkText||"View Bundle"),this.themeData={},this.themeStoreId&&this.themeDataJson&&this.themeDataJson[this.themeStoreId]&&(this.themeData=this.themeDataJson[this.themeStoreId]),this.embedData=this.themeData?.e,this.embedData&&this.embedData.qab&&this.embedData.qab.length>0){const t=this.embedData.qab.join(" ");this.quickAddButtonClasses&&this.quickAddButtonClasses.length>0?this.quickAddButtonClasses+=" "+t:this.quickAddButtonClasses=t}},parseThemeData:function(){const t=this;let e={};try{e=JSON.parse(t.appEmbedJsonElement.innerHTML)}catch(t){console.log(t)}return e},_createDebouncedObserver:function(t){let e=null;t();const i=new MutationObserver((i=>{i.some((t=>t.addedNodes.length>0))&&(e&&clearTimeout(e),e=setTimeout((()=>{requestAnimationFrame(t)}),500))}));return i.observe(document.body,{childList:!0,subtree:!0}),i},initBothButtons:function(){this.bothButtonObserver=this._createDebouncedObserver((()=>this.applyBothButtons()))},disconnectBothButtonObserver:function(){this.bothButtonObserver&&this.bothButtonObserver.disconnect()},initQuickAddButtons:function(){this.quickAddObserver=this._createDebouncedObserver((()=>this.applyQuickAddButtons()))},disconnectQuickAddObserver:function(){this.quickAddObserver&&this.quickAddObserver.disconnect()},initQuickViewButtons:function(){this.quickViewObserver=this._createDebouncedObserver((()=>this.applyQuickViewButtons()))},disconnectQuickViewObserver:function(){this.quickViewObserver&&this.quickViewObserver.disconnect()},isBiscuitsButton:function(t){const e=t.classList&&t.classList.contains("biscuits-bundle-add-to-cart__button"),i=t.closest&&null!==t.closest(".biscuits-bundles-main-product-form");return e||i},applyBothButtons:function(){const e=this,i=document.querySelectorAll(e.cachedQuickAddQuery);if(0===i.length)return void e.applyQuickViewButtons();let o=0;i.forEach((i=>{if(t.has(i))return;if(t.add(i),e.isBiscuitsButton(i))return;if(e.isProductPage&&e._isProductPageForm(i))return;const u=e._isBundleProductButton(i);if(!u)return;if(i.dataset.biscuitsBundleButton)return;let d="";const s=i.closest(e.productGridItemQuery);if(s){const t=s.querySelector('a[href*="/products/"]');t&&(d=t.href),s.dataset.biscuitsBundleDetected=!0;const i=s.querySelector(e.cachedQuickViewQuery);if(i){if(e.isBiscuitsButton(i))return;if(i.dataset.biscuitsBundleButton)return;e._applyDisplayRule(i,e.quickViewDisplayRule)}}else o++;e._applyDisplayRule(i,e.quickAddDisplayRule,u,d)})),o>0&&e.applyQuickViewButtons()},_applyDisplayRule:function(t,e,i,o){switch(e){case"replace":this.replaceQuickAddButton(t,i,o);break;case"hide":this.hideButton(t);break;case"disable":this.disableButton(t)}},applyQuickAddButtons:function(){const e=this;document.querySelectorAll(e.cachedQuickAddQuery).forEach((i=>{if(t.has(i))return;if(t.add(i),e.isBiscuitsButton(i))return;if(e.isProductPage&&e._isProductPageForm(i))return;const o=e._isBundleProductButton(i);if(!o)return;if(i.dataset.biscuitsBundleButton)return;let u="";const d=i.closest(e.productGridItemQuery);if(d){const t=d.querySelector('a[href*="/products/"]');t&&(u=t.href),d.dataset.biscuitsBundleDetected=!0}e._applyDisplayRule(i,e.quickAddDisplayRule,o,u)}))},applyQuickViewButtons:function(){const e=this;let i=document.querySelectorAll(e.cachedQuickViewQuery);0!==i.length&&i.forEach((function(i){if(t.has(i))return;if(t.add(i),e.isBiscuitsButton(i))return;if(e.isProductPage&&e._isProductPageForm(i))return;e._isBundleProductButton(i)&&e._applyDisplayRule(i,e.quickViewDisplayRule)}))},hideButton:function(t){t.classList.add("disabled"),t.classList.add("biscuits--disabled"),t.classList.add("biscuits--hidden"),t.setAttribute("disabled",!0),t.style.display="none",t.style.visibility="hidden",t.style.pointerEvents="none",t.style.opacity="0"},disableButton:function(t){t.classList.add("disabled"),t.classList.add("biscuits--disabled"),t.setAttribute("disabled",!0)},removeButton:function(t){t.remove()},replaceQuickAddButton:function(t,e,i){const o=this;if("quick-add-bulk"===t.tagName.toLowerCase()||t.classList.contains("product-item__quick-add-qty-selector")||t.classList.contains("input-amount"))return void o.removeButton(t);let u=document.createElement("a");if("INPUT"===t.tagName)u.textContent=o.linkText;else{let e=t.cloneNode(!0);o._replaceButtonText(e),Array.from(e.childNodes).forEach((t=>{u.appendChild(t)}));let i=u.querySelector(".push-btn__surface");i&&i.removeAttribute("x-text")}if(u.href=i,u.dataset.biscuitsBundleButton=e,o.quickAddButtonClasses&&o.quickAddButtonClasses.length>0){o.quickAddButtonClasses.trim().replace(/\s+/g," ").split(" ").forEach((t=>{u.classList.add(t)}))}u=o._addButtonClasses(t,u),0===u.classList.length&&(u=o._applyButtonStyles(t,u)),u.style.textDecoration="none",t.replaceWith(u)},_replaceButtonText:function(t){const e=this,i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,{acceptNode:t=>/\S/.test(t.nodeValue)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),o=[];for(;i.nextNode();)o.push(i.currentNode);let u=!1;if(o.length>0)for(let t=0;t<o.length;t++){o[t].nodeValue.toLowerCase().length>1&&!u?(o[t].nodeValue=e.linkText,u=!0):o[t].nodeValue=""}},_isProductPageForm:function(t){if(this.productFormClasses.some((e=>t.closest(e))))return!0;const e=t.closest('[action*="/cart/add"]');return!!e&&null!==e.querySelector('input[type="text"][name="properties[_bundleId]"].biscuits--hidden')},_isBundleProductButton:function(t){const e=this;let i=!1;const o=(t,e)=>t&&t.indexOf(e)>-1;return e.bundleIds.forEach((u=>{const d=t.closest('[action*="/cart/add"]');if(d&&e._isFormEligible(d,u)||t.form&&e._isFormEligible(t.form,u))return void(i=u);if([t.getAttribute("id"),t.dataset.id,t.dataset.index,t.dataset.variantId,t.dataset.variantid,t.dataset.variant,t.dataset.productId,t.dataset.product,Array.from(t.classList).join(",")].some((t=>o(t,u))))return void(i=u);let s=t.parentNode.dataset.id,c=t.parentNode.getAttribute("id");if(s&&o(s,u)||c&&o(c,u))return void(i=u);const r=t.closest(e.productGridItemQuery);if(r){if([r.dataset.productId,r.dataset.variantId].some((t=>o(t,u))))return void(i=u)}})),i},_isFormEligible:function(t,e){const i=t=>"string"==typeof t&&t.indexOf(e)>-1,o=i(t.getAttribute("id"));let u=!1;const d=t.elements.id||t.querySelector("#id");d&&d.value&&(u=i(d.value));const s=i(t.id);return o||u||s},_addButtonClasses:function(t,e){const i=Array.from(t.classList);if(null!==t.closest("quick-add-component"))return i.forEach((t=>e.classList.add(t))),e;const o=["quick","add to cart","add-to-cart","buy","quick view","quick-view","quickview","quickbuy","quick-buy"];return i.forEach((t=>{const i=t.toLowerCase();o.some((t=>{const e=i.replace(/[- ]/g,""),o=t.replace(/[- ]/g,"");return e.includes(o)}))||e.classList.add(t)})),e},_applyButtonStyles:function(t,e){const i=window.getComputedStyle(t);return["padding","backgroundColor","color","border","borderRadius","cursor","textAlign","display","position","top","right","left","bottom","width","height","boxShadow","lineHeight","boxSizing","minHeight","alignItems","justifyContent","zIndex","pointerEvents"].forEach((t=>{e.style[t]=i[t]})),e.style.textDecoration="none",e.style.overflow="hidden",e}},e}(),window.BiscuitsBundle.bundleButtons=new window.BiscuitsBundle.InitialiseBundleButtons;